{"ast":null,"code":"var _jsxFileName = \"/Users/manikdhiman/Desktop/Programs/Video Streaming Application/frontend/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport \"./App.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [videos, setVideos] = useState([]);\n  const [selectedVideo, setSelectedVideo] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [videoUrl, setVideoUrl] = useState(null); // To store the URL for video stream\n\n  useEffect(() => {\n    fetchVideos();\n  }, []);\n  const fetchVideos = async () => {\n    setIsLoading(true);\n    try {\n      const response = await fetch(\"http://127.0.0.1:5000/api/videos\");\n      const data = await response.json();\n      setVideos(data);\n      setIsLoading(false);\n    } catch (error) {\n      console.error(\"Error fetching videos:\", error);\n      setIsLoading(false);\n    }\n  };\n  const handleVideoClick = async filename => {\n    setSelectedVideo(filename);\n    const videoStreamUrl = await fetchVideoStream(filename);\n    setVideoUrl(videoStreamUrl);\n  };\n  const fetchVideoStream = async filename => {\n    try {\n      const response = await fetch(`http://127.0.0.1:5000/api/video/${filename}`);\n      const data = await response.json();\n      if (data.presigned_url) {\n        return data.presigned_url; // Use the presigned URL to stream video\n      } else {\n        return null;\n      }\n    } catch (error) {\n      console.error(\"Error fetching video stream:\", error);\n      return null;\n    }\n  };\n\n  // Handle video range request for streaming\n  const handleVideoStream = videoUrl => {\n    if (!videoUrl) return;\n    const videoElement = document.getElementById(\"video-player\");\n    const rangeSize = 1024 * 1024; // 1 MB for each range\n\n    let startByte = 0;\n    let endByte = rangeSize - 1;\n    const fetchAndPlayRange = async () => {\n      try {\n        const rangeHeader = `bytes=${startByte}-${endByte}`;\n        const response = await fetch(videoUrl, {\n          method: \"GET\",\n          headers: {\n            \"Range\": rangeHeader\n          }\n        });\n        if (response.ok) {\n          const videoBlob = await response.blob();\n          const videoUrl = URL.createObjectURL(videoBlob);\n          videoElement.src = videoUrl;\n\n          // Prepare for the next range\n          startByte = endByte + 1;\n          endByte = startByte + rangeSize - 1;\n\n          // Check if we have reached the end of the video\n          if (videoBlob.size === rangeSize) {\n            fetchAndPlayRange(); // Fetch next chunk\n          }\n        } else {\n          console.error(\"Error fetching video range:\", response.statusText);\n        }\n      } catch (error) {\n        console.error(\"Error during video range request:\", error);\n      }\n    };\n    fetchAndPlayRange();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Video List\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), isLoading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading videos...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: videos.map((video, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleVideoClick(video.filename),\n            children: video.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 17\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }, this), selectedVideo && videoUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-player\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: selectedVideo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        id: \"video-player\",\n        controls: true,\n        width: \"600\",\n        height: \"400\",\n        onPlay: () => handleVideoStream(videoUrl),\n        children: \"Your browser does not support the video tag.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"YmBAz+x03vLxXIJUm8gT81EVqiU=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","jsxDEV","_jsxDEV","App","_s","videos","setVideos","selectedVideo","setSelectedVideo","isLoading","setIsLoading","videoUrl","setVideoUrl","fetchVideos","response","fetch","data","json","error","console","handleVideoClick","filename","videoStreamUrl","fetchVideoStream","presigned_url","handleVideoStream","videoElement","document","getElementById","rangeSize","startByte","endByte","fetchAndPlayRange","rangeHeader","method","headers","ok","videoBlob","blob","URL","createObjectURL","src","size","statusText","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","video","index","onClick","title","id","controls","width","height","onPlay","_c","$RefreshReg$"],"sources":["/Users/manikdhiman/Desktop/Programs/Video Streaming Application/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./App.css\";\n\nfunction App() {\n  const [videos, setVideos] = useState([]);\n  const [selectedVideo, setSelectedVideo] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [videoUrl, setVideoUrl] = useState(null); // To store the URL for video stream\n\n  useEffect(() => {\n    fetchVideos();\n  }, []);\n\n  const fetchVideos = async () => {\n    setIsLoading(true);\n    try {\n      const response = await fetch(\"http://127.0.0.1:5000/api/videos\");\n      const data = await response.json();\n      setVideos(data);\n      setIsLoading(false);\n    } catch (error) {\n      console.error(\"Error fetching videos:\", error);\n      setIsLoading(false);\n    }\n  };\n\n  const handleVideoClick = async (filename) => {\n    setSelectedVideo(filename);\n    const videoStreamUrl = await fetchVideoStream(filename);\n    setVideoUrl(videoStreamUrl);\n  };\n\n  const fetchVideoStream = async (filename) => {\n    try {\n      const response = await fetch(`http://127.0.0.1:5000/api/video/${filename}`);\n      const data = await response.json();\n      if (data.presigned_url) {\n        return data.presigned_url; // Use the presigned URL to stream video\n      } else {\n        return null;\n      }\n    } catch (error) {\n      console.error(\"Error fetching video stream:\", error);\n      return null;\n    }\n  };\n\n  // Handle video range request for streaming\n  const handleVideoStream = (videoUrl) => {\n    if (!videoUrl) return;\n\n    const videoElement = document.getElementById(\"video-player\");\n    const rangeSize = 1024 * 1024; // 1 MB for each range\n\n    let startByte = 0;\n    let endByte = rangeSize - 1;\n\n    const fetchAndPlayRange = async () => {\n      try {\n        const rangeHeader = `bytes=${startByte}-${endByte}`;\n        const response = await fetch(videoUrl, {\n          method: \"GET\",\n          headers: {\n            \"Range\": rangeHeader,\n          },\n        });\n\n        if (response.ok) {\n          const videoBlob = await response.blob();\n          const videoUrl = URL.createObjectURL(videoBlob);\n          videoElement.src = videoUrl;\n\n          // Prepare for the next range\n          startByte = endByte + 1;\n          endByte = startByte + rangeSize - 1;\n\n          // Check if we have reached the end of the video\n          if (videoBlob.size === rangeSize) {\n            fetchAndPlayRange(); // Fetch next chunk\n          }\n        } else {\n          console.error(\"Error fetching video range:\", response.statusText);\n        }\n      } catch (error) {\n        console.error(\"Error during video range request:\", error);\n      }\n    };\n\n    fetchAndPlayRange();\n  };\n\n  return (\n    <div className=\"App\">\n      <h1>Video List</h1>\n      {isLoading ? (\n        <p>Loading videos...</p>\n      ) : (\n        <div>\n          <ul>\n            {videos.map((video, index) => (\n              <li key={index}>\n                <button onClick={() => handleVideoClick(video.filename)}>\n                  {video.title}\n                </button>\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n\n      {selectedVideo && videoUrl && (\n        <div className=\"video-player\">\n          <h2>{selectedVideo}</h2>\n          <video\n            id=\"video-player\"\n            controls\n            width=\"600\"\n            height=\"400\"\n            onPlay={() => handleVideoStream(videoUrl)}\n          >\n            Your browser does not support the video tag.\n          </video>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}